<div class="row g-0" id="product-grid">
    {% if products %}
        {% for product in products %}
        <div class="col-xl-4 col-lg-4 col-md-6 col-sm-6 mb-30">
            <div class="product__item product__item-d">
                <div class="product__thumb fix">
                    <div class="product-image w-img">
                        <a href="{% url 'product-detail' product.slug product.id %}">
                            <img src="{{product.images.first.image.url}}" alt="{{product.title|title}}" style="width: 310px; height: 350px; object-fit: cover">
                        </a>
                    </div>
                    {% if product.deadline %}
                    <div class="countdown countdown-small mt-5">
                        <div class="countdown-inner b-radius"
                            data-countdown=""
                            data-date="{{ product.deadline|date:'c' }}">
                            <ul class="text-center" style="padding:0; list-style:none; display:flex; justify-content:center; gap:10px;">
                                <li><span data-days="">0</span>d</li>
                                <li><span data-hours="">0</span>h</li>
                                <li><span data-minutes="">0</span>m</li>
                                <li><span data-seconds="">0</span>s</li>
                            </ul>
                        </div>
                    </div>
                    {% endif %}
                    <div class="product__offer">
                        <span class="discount">-{{product.discount_percent}}%</span>
                    </div>
                    <div class="product-action">
                        <a href="#" class="icon-box icon-box-1" data-bs-toggle="modal" data-bs-target="#productModalId">
                            <i class="fal fa-eye"></i>
                            <i class="fal fa-eye"></i>
                        </a>
                        <a href="#" class="icon-box icon-box-1">
                            <i class="fal fa-heart"></i>
                            <i class="fal fa-heart"></i>
                        </a>
                        <a href="#" class="icon-box icon-box-1">
                            <i class="fal fa-layer-group"></i>
                            <i class="fal fa-layer-group"></i>
                        </a>
                    </div>
                </div>
                <div class="product__content">
                    <h6><a href="{% url 'product-detail' product.slug product.id %}">{{product.title|title|truncatewords:5}}</a></h6>
                    <div class="rating mb-5">
                        <ul>
                            <i class="fa {% if product.avg_rate >= 1 %}fa-star{% else %}fa-star-o{% endif %}" style="color: #FFD700;"></i>
                            <i class="fa {% if product.avg_rate >= 2 %}fa-star{% else %}fa-star-o{% endif %}" style="color: #FFD700;"></i>
                            <i class="fa {% if product.avg_rate >= 3 %}fa-star{% else %}fa-star-o{% endif %}" style="color: #FFD700;"></i>
                            <i class="fa {% if product.avg_rate >= 4 %}fa-star{% else %}fa-star-o{% endif %}" style="color: #FFD700;"></i>
                            <i class="fa {% if product.avg_rate >= 5 %}fa-star{% else %}fa-star-o{% endif %}" style="color: #FFD700;"></i>
                        </ul>
                        <span>({{ product.reviews.count }} review{{ product.reviews.count|pluralize }})</span>
                    </div>
                    <div class="price mb-10"><span>
                       $ {{product.sale_price}}
                        <del class="text-danger">
                        {% if product.old_price %}
                           $ {{product.old_price}}
                        {% endif %}
                        </del>
                    </span></div>
                    <div class="progress mb-5">
                        <div class="progress-bar bg-danger" style="width:10%"></div>
                    </div>
                    <div class="progress-rate"><span>Sold {{product.sold}}</span></div>
                </div>
                <div class="product__add-cart text-center">
                    <button class="cart-btn w-100">Add to Cart</button>
                </div>
            </div>  
        </div>
        {% endfor %}
    {% else %}
        <p>No products found!</p>
    {% endif %}
</div>